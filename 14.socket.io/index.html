<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="bootstrap.min.css">
</head>
<body class="container" style="margin-top: 30px">
<div class="panel panel-primary">
    <div class="panel-heading">
        欢迎光临珠峰聊天室
    </div>
    <div class="panel-body">
        <ul class="list-group" id="messages"></ul>
    </div>
    <div class="panel-footer">
        <input onkeydown="enter(event)" type="text" class="form-control" id="inputMsg">
        <button class="btn btn-primary" onclick="talk()">发言</button>
    </div>
</div>
</body>
<script src="/socket.io/socket.io.js"></script>
<script>
    window.onload = function(){
        //连接websocket服务器
        var socket = io.connect('/');
        socket.on('connect',function(){
            console.log('成功连接');
            //socket.send('服务器');
            socket.emit('message','服务器');
        });
        socket.on('disconnect',function(){
            console.log('断开连接');
        });
        socket.on('message',function(msg){
            var li = document.createElement('li');
            li.className = 'list-group-item';
            li.innerHTML = msg;
            document.querySelector('#messages').appendChild(li);
        });

        window.enter = function(event){
            var key = event.which || event.keyCode;
            if(key == 13){
                window.talk();
            }
        }
        //发言
        window.talk = function(){
            var msg = document.querySelector('#inputMsg').value;
            //向服务器发送类型为message的消息
            socket.emit('message',msg);
            document.querySelector('#inputMsg').value = '';
        }
    }

</script>
</html>